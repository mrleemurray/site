import{d as G,r as d,c as P,w as Y,o as J,a as K,b as a,e as l,h,k as M,l as T,p as Q,q as X,n as R,f as g,F as w,g as b,s as Z,i as ee,j as i,v as te,m as B,_ as se}from"./index-Ba4rGkwL.js";import{I as H,M as U}from"./image-optimizer-GJeAsu8N.js";const le={class:"project-detail"},oe={class:"project-container"},ne={key:0,class:"loading-state"},re={key:1,class:"error-state"},ae={key:2},ie={class:"project-image"},ce=["alt"],ue={class:"project-content"},de={class:"content-main"},pe={class:"project-links"},ge=["href"],ve=["href"],me={class:"project-tags"},fe=["innerHTML"],he={key:1,class:"content-loading"},_e={class:"toc","aria-label":"Table of contents"},ke=["href","onClick"],ye={key:0,class:"related-projects"},$e={class:"related-grid grid grid-responsive"},we={class:"related-image"},be=["src","alt"],je={class:"related-tags"},Se=G({__name:"Project",props:{slug:{}},emits:["sticky-title-change"],setup(V,{emit:z}){const j=V,_=z,o=d(null),S=d([]),v=d(""),k=d([]),x=d(!1),C=d(null),y=d(!1),m=d(),D=d();let f=null;const E=P(()=>!o.value||!S.value.length?[]:S.value.filter(e=>e.id!==o.value.id&&(e.category===o.value.category||e.tags.some(t=>o.value.tags.includes(t)))).slice(0,4)),L=(e,t=!1)=>{if(!e)return"";if(e.startsWith("http"))return e;if(t){const c=H.isGif(e),p={viewMode:"hero",isMobile:window.innerWidth<=767,isRetina:window.devicePixelRatio>1,preferAnimation:c};try{return H.getImageSrc(e,p)}catch(s){console.warn("Failed to get optimized hero image, falling back to original:",s)}}return e.startsWith("/")?e:`/${e}`},F=()=>{y.value=!0},N=()=>{y.value=!0},I=async()=>{x.value=!0,C.value=null,o.value=null,v.value="",k.value=[],y.value=!1,_("sticky-title-change",null);try{const e=await U.loadProjectsData();S.value=e.projects;const t=await U.loadProjectContent(j.slug);o.value=t.frontmatter,_("sticky-title-change",o.value.title);const c=t.content.matchAll(/^(#{1,6})\s+(.*)$/gm),p=Array.from(c).map(n=>{const r=n[1].length,u=n[2].trim(),$=u.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");return{level:r,text:u,id:$}});k.value=p;let s=t.content.replace(/^### (.*$)/gim,(n,r)=>`<h3 id="${r.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}">${r}</h3>`).replace(/^## (.*$)/gim,(n,r)=>`<h2 id="${r.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}">${r}</h2>`).replace(/^# (.*$)/gim,(n,r)=>`<h1 id="${r.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}">${r}</h1>`).replace(/\*\*\*(.*?)\*\*\*/g,"<strong><em>$1</em></strong>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/::: info\n([\s\S]*?)\n:::/g,'<div class="callout callout-info"><p>$1</p></div>').replace(/::: tip\n([\s\S]*?)\n:::/g,'<div class="callout callout-tip"><p>$1</p></div>').replace(/::: warning\n([\s\S]*?)\n:::/g,'<div class="callout callout-warning"><p>$1</p></div>').replace(/::: danger\n([\s\S]*?)\n:::/g,'<div class="callout callout-danger"><p>$1</p></div>').replace(/^- \[ \] (.*)$/gm,'<li class="task-list-item"><input type="checkbox" disabled> $1</li>').replace(/^- \[x\] (.*)$/gm,'<li class="task-list-item"><input type="checkbox" checked disabled> $1</li>').replace(/==(.*?)==/g,"<mark>$1</mark>").replace(/\+\+(.*?)\+\+/g,"<ins>$1</ins>").replace(/```(\w+)?\n([\s\S]*?)```/g,'<pre><code class="hljs language-$1">$2</code></pre>').replace(/`([^`]+)`/g,"<code>$1</code>").replace(/!\[([^\]]*)\]\(([^)]+)\)/g,(n,r,u)=>{const $=r||"Project image";return`<img src="${L(u)}" alt="${$}" />`}).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>').replace(/^- (.*)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)(\n<li>.*<\/li>)*/g,n=>"<ul>"+n.replace(/\n/g,"")+"</ul>").replace(/(<li class="task-list-item">.*<\/li>)(\n<li class="task-list-item">.*<\/li>)*/g,n=>"<ul>"+n.replace(/\n/g,"")+"</ul>").split(`

`).map(n=>{const r=n.trim();return r===""?"":r.startsWith("<")?r:`<p>${r}</p>`}).filter(n=>n!=="").join(`
`);v.value=s,await Z(),setTimeout(()=>{A()},100)}catch(e){console.error("❌ Error loading project:",e),C.value=e instanceof Error?e.message:"Failed to load project"}finally{x.value=!1}};Y(()=>j.slug,()=>{I()});const A=()=>{if(!m.value)return;const e=document.createElement("div");e.style.height="1px",e.style.position="absolute",e.style.top="calc(var(--space-16) - 7px)",e.style.left="0",e.style.right="0",e.style.pointerEvents="none",e.setAttribute("data-sticky-sentinel","true"),m.value.parentNode?.insertBefore(e,m.value),f=new IntersectionObserver(t=>{t.forEach(c=>{c.target===e&&(!c.isIntersecting&&o.value?.title?_("sticky-title-change",o.value.title):window.innerWidth<=767||_("sticky-title-change",null))})},{rootMargin:"0px",threshold:0}),f.observe(e)},W=()=>{f&&(f.disconnect(),f=null),document.querySelectorAll("[data-sticky-sentinel]").forEach(t=>t.remove())},q=e=>{const t=document.getElementById(e);if(!t)return;const c=m.value?.offsetHeight||0,p=getComputedStyle(document.documentElement),u=(parseFloat(p.getPropertyValue("--space-16"))*16||64)-6+c+20,O=t.getBoundingClientRect().top+window.pageYOffset-u;window.scrollTo({top:O,behavior:"smooth"})};return J(()=>{I()}),K(()=>{W()}),(e,t)=>{const c=ee("router-link"),p=X("lazy");return i(),a("div",le,[l("div",oe,[x.value?(i(),a("div",ne,[...t[0]||(t[0]=[l("div",{class:"loading-spinner"},null,-1),l("p",null,"Loading project...",-1)])])):C.value?(i(),a("div",re,[t[2]||(t[2]=l("h2",null,"Project Not Found",-1)),M(c,{to:"/",class:"btn btn-primary"},{default:T(()=>[...t[1]||(t[1]=[B(" ← Back to Projects ",-1)])]),_:1})])):o.value?(i(),a("div",ae,[l("div",ie,[Q(l("img",{alt:o.value.title,class:R({loaded:y.value}),onLoad:F,onError:N},null,42,ce),[[p,L(o.value.image,!0)]])]),l("div",ue,[l("div",de,[l("div",{ref_key:"projectMetaRef",ref:m,class:"project-meta"},[l("div",pe,[o.value.liveUrl?(i(),a("a",{key:0,href:o.value.liveUrl,class:"project-link",target:"_blank",rel:"noopener noreferrer"},g(o.value.liveUrlLabel||"View Live Site"),9,ge)):h("",!0),o.value.sourceUrl?(i(),a("a",{key:1,href:o.value.sourceUrl,class:"project-link",target:"_blank",rel:"noopener noreferrer"},g(o.value.sourceUrlLabel||"View Source"),9,ve)):h("",!0)]),l("div",me,[(i(!0),a(w,null,b(o.value.tags,s=>(i(),a("span",{key:s,class:"tag"},g(s),1))),128))])],512),v.value?(i(),a("div",{key:`markdown-${j.slug}-${v.value.length}`,class:"markdown-content",innerHTML:v.value},null,8,fe)):(i(),a("div",he,[...t[3]||(t[3]=[l("p",null,"Loading project details...",-1)])]))]),k.value.length>0?(i(),a("aside",{key:0,ref_key:"tocRef",ref:D,class:"content-sidebar"},[l("nav",_e,[t[4]||(t[4]=l("h3",null,"Table of Contents",-1)),l("ul",null,[(i(!0),a(w,null,b(k.value,s=>(i(),a("li",{key:s.id,class:R(`toc-level-${s.level}`)},[l("a",{href:`#${s.id}`,onClick:te(n=>q(s.id),["prevent"])},g(s.text),9,ke)],2))),128))])])],512)):h("",!0)]),E.value.length>0?(i(),a("section",ye,[t[5]||(t[5]=l("h2",null,"Related Projects",-1)),l("div",$e,[(i(!0),a(w,null,b(E.value,s=>(i(),a("article",{key:s.id,class:"related-card"},[l("div",we,[M(c,{to:`/projects/${s.id}`},{default:T(()=>[l("img",{src:L(s.image),alt:s.title,loading:"lazy"},null,8,be)]),_:2},1032,["to"])]),l("h3",null,[M(c,{to:`/projects/${s.id}`},{default:T(()=>[B(g(s.title),1)]),_:2},1032,["to"])]),l("p",null,g(s.description),1),l("div",je,[(i(!0),a(w,null,b(s.tags.slice(0,3),n=>(i(),a("span",{key:n,class:"tag"},g(n),1))),128))])]))),128))])])):h("",!0)])):h("",!0)])])}}}),Le=se(Se,[["__scopeId","data-v-67ce2d4c"]]);export{Le as default};
