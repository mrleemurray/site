import{d as H,r as v,c as N,q as W,o as q,a as Y,b as r,e as o,h as $,l as T,w as M,m as G,j as J,f,F as j,g as L,s as K,i as Q,k as c,n as X,v as Z,p as I,_ as ee}from"./index-BjbnYrZD.js";import{M as P}from"./projects-BGVd_e6Y.js";const te={class:"project-detail"},le={class:"project-container"},se={key:0,class:"loading-state"},oe={key:1,class:"error-state"},ae={key:2},ne={class:"project-image"},re=["alt"],ce={class:"project-content"},ie={class:"content-main"},de={class:"project-links"},ue=["href"],ge=["href"],pe={class:"project-tags"},ve=["innerHTML"],me={key:1,class:"content-loading"},fe={class:"toc","aria-label":"Table of contents"},he=["href","onClick"],ke={key:0,class:"related-projects"},ye={class:"related-grid grid grid-responsive"},_e={class:"related-image"},$e=["src","alt"],we={class:"related-tags"},be=H({__name:"Project",props:{slug:{}},emits:["sticky-title-change"],setup(B,{emit:R}){const h=B,w=R,a=v(null),C=v([]),u=v(""),m=v([]),x=v(!1),S=v(null),k=v(),F=v();let y=null;const O=N(()=>!a.value||!C.value.length?[]:C.value.filter(t=>t.id!==a.value.id&&(t.category===a.value.category||t.tags.some(e=>a.value.tags.includes(e)))).slice(0,4)),z=t=>{if(!t)return"";if(t.startsWith("http"))return t;const e=window.location.hostname==="mrleemurray.github.io"?"/site":"";return t.startsWith("/")?`${e}${t}`:`${e}/${t}`},E=async()=>{console.log("üöÄ loadProject called for slug:",h.slug),x.value=!0,S.value=null,a.value=null,u.value="",m.value=[],w("sticky-title-change",null);try{console.log("üì• Loading projects data...");const t=await P.loadProjectsData();C.value=t.projects,console.log("‚úÖ Projects data loaded:",t.projects.length),console.log("üìÑ Loading project content for:",h.slug);const e=await P.loadProjectContent(h.slug);a.value=e.frontmatter,console.log("‚úÖ Project frontmatter loaded:",a.value.title),console.log("üìù Raw content length:",e.content.length),console.log("üìù Content preview:",e.content.substring(0,200)),console.log("üîß Starting enhanced markdown processing..."),console.log("üîß Raw markdown sample:",e.content.substring(0,500)),w("sticky-title-change",a.value.title);const i=window.location.hostname==="mrleemurray.github.io"?"/site":"";console.log("üîó Base path:",i),console.log("‚öôÔ∏è Processing markdown with fallback approach...");let g=e.content;i&&(g=e.content.replace(/!\[([^\]]*)\]\(([^)]+)\)/gim,(l,n,d)=>{const b=d.startsWith("/")?`${i}${d}`:d.startsWith("http")?d:`${i}/${d}`;return`![${n}](${b})`}));const s=e.content.matchAll(/^(#{1,6})\s+(.*)$/gm),p=Array.from(s).map(l=>{const n=l[1].length,d=l[2].trim(),b=d.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");return{level:n,text:d,id:b}});m.value=p,console.log("üìö TOC extracted:",m.value.length,"items"),m.value.length>0&&console.log("üìö TOC items:",m.value);let _=g.replace(/^### (.*$)/gim,(l,n)=>`<h3 id="${n.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}">${n}</h3>`).replace(/^## (.*$)/gim,(l,n)=>`<h2 id="${n.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}">${n}</h2>`).replace(/^# (.*$)/gim,(l,n)=>`<h1 id="${n.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}">${n}</h1>`).replace(/\*\*\*(.*?)\*\*\*/g,"<strong><em>$1</em></strong>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/::: info\n([\s\S]*?)\n:::/g,'<div class="callout callout-info"><p>$1</p></div>').replace(/::: tip\n([\s\S]*?)\n:::/g,'<div class="callout callout-tip"><p>$1</p></div>').replace(/::: warning\n([\s\S]*?)\n:::/g,'<div class="callout callout-warning"><p>$1</p></div>').replace(/::: danger\n([\s\S]*?)\n:::/g,'<div class="callout callout-danger"><p>$1</p></div>').replace(/^- \[ \] (.*)$/gm,'<li class="task-list-item"><input type="checkbox" disabled> $1</li>').replace(/^- \[x\] (.*)$/gm,'<li class="task-list-item"><input type="checkbox" checked disabled> $1</li>').replace(/==(.*?)==/g,"<mark>$1</mark>").replace(/\+\+(.*?)\+\+/g,"<ins>$1</ins>").replace(/```(\w+)?\n([\s\S]*?)```/g,'<pre><code class="hljs language-$1">$2</code></pre>').replace(/`([^`]+)`/g,"<code>$1</code>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>').replace(/!\[([^\]]*)\]\(([^)]+)\)/g,(l,n,d)=>`<img data-lazy="${d}" alt="${n||"Project image"}" class="lazy-image" />`).replace(/^- (.*)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)(\n<li>.*<\/li>)*/g,l=>"<ul>"+l.replace(/\n/g,"")+"</ul>").replace(/(<li class="task-list-item">.*<\/li>)(\n<li class="task-list-item">.*<\/li>)*/g,l=>"<ul>"+l.replace(/\n/g,"")+"</ul>").split(`

`).map(l=>{const n=l.trim();return n===""?"":n.startsWith("<")?n:`<p>${n}</p>`}).filter(l=>l!=="").join(`
`);u.value=_,console.log("‚úÖ Manual markdown processing complete, length:",u.value.length),console.log("üé® Final content preview:",u.value.substring(0,300)),await K(),A(),console.log("üîç Final markdown content check:",{hasCallouts:u.value.includes("callout-"),hasTaskLists:u.value.includes("task-list-item"),hasHTML:u.value.includes("<"),isEmpty:u.value.trim()===""}),setTimeout(()=>{U()},100)}catch(t){console.error("‚ùå Error loading project:",t),S.value=t instanceof Error?t.message:"Failed to load project"}finally{x.value=!1,console.log("üèÅ loadProject completed")}};W(()=>h.slug,()=>{E()});const U=()=>{if(!k.value)return;const t=document.createElement("div");t.style.height="1px",t.style.position="absolute",t.style.top="calc(var(--space-16) - 7px)",t.style.left="0",t.style.right="0",t.style.pointerEvents="none",t.setAttribute("data-sticky-sentinel","true"),k.value.parentNode?.insertBefore(t,k.value),y=new IntersectionObserver(e=>{e.forEach(i=>{i.target===t&&(!i.isIntersecting&&a.value?.title?w("sticky-title-change",a.value.title):window.innerWidth<=767||w("sticky-title-change",null))})},{rootMargin:"0px",threshold:0}),y.observe(t)},V=()=>{y&&(y.disconnect(),y=null),document.querySelectorAll("[data-sticky-sentinel]").forEach(e=>e.remove())},A=()=>{document.querySelectorAll(".markdown-content img[data-lazy]").forEach(e=>{const i=e.getAttribute("data-lazy");i&&new IntersectionObserver((s,p)=>{s.forEach(_=>{if(_.isIntersecting){const l=_.target;l.src=i,l.classList.add("lazy-loading"),l.onload=()=>{l.classList.remove("lazy-loading"),l.classList.add("lazy-loaded")},l.onerror=()=>{l.classList.remove("lazy-loading"),l.classList.add("lazy-error"),l.src=z("/images/error-placeholder.svg")},p.unobserve(l)}})},{rootMargin:"50px"}).observe(e)})},D=t=>{const e=document.getElementById(t);if(!e)return;const i=k.value?.offsetHeight||0,g=getComputedStyle(document.documentElement),l=(parseFloat(g.getPropertyValue("--space-16"))*16||64)-6+i+20,d=e.getBoundingClientRect().top+window.pageYOffset-l;window.scrollTo({top:d,behavior:"smooth"})};return q(()=>{E()}),Y(()=>{V()}),(t,e)=>{const i=Q("router-link"),g=J("lazy");return c(),r("div",te,[o("div",le,[x.value?(c(),r("div",se,[...e[0]||(e[0]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"Loading project...",-1)])])):S.value?(c(),r("div",oe,[e[2]||(e[2]=o("h2",null,"Project Not Found",-1)),T(i,{to:"/",class:"btn btn-primary"},{default:M(()=>[...e[1]||(e[1]=[I(" ‚Üê Back to Projects ",-1)])]),_:1})])):a.value?(c(),r("div",ae,[o("div",ne,[G(o("img",{alt:a.value.title},null,8,re),[[g,z(a.value.image)]])]),o("div",ce,[o("div",ie,[o("div",{ref_key:"projectMetaRef",ref:k,class:"project-meta"},[o("div",de,[a.value.liveUrl?(c(),r("a",{key:0,href:a.value.liveUrl,class:"project-link",target:"_blank",rel:"noopener noreferrer"},f(a.value.liveUrlLabel||"View Live Site"),9,ue)):$("",!0),a.value.sourceUrl?(c(),r("a",{key:1,href:a.value.sourceUrl,class:"project-link",target:"_blank",rel:"noopener noreferrer"},f(a.value.sourceUrlLabel||"View Source"),9,ge)):$("",!0)]),o("div",pe,[(c(!0),r(j,null,L(a.value.tags,s=>(c(),r("span",{key:s,class:"tag"},f(s),1))),128))])],512),u.value?(c(),r("div",{key:`markdown-${h.slug}-${u.value.length}`,class:"markdown-content",innerHTML:u.value},null,8,ve)):(c(),r("div",me,[...e[3]||(e[3]=[o("p",null,"Loading project details...",-1)])]))]),m.value.length>0?(c(),r("aside",{key:0,ref_key:"tocRef",ref:F,class:"content-sidebar"},[o("nav",fe,[e[4]||(e[4]=o("h3",null,"Table of Contents",-1)),o("ul",null,[(c(!0),r(j,null,L(m.value,s=>(c(),r("li",{key:s.id,class:X(`toc-level-${s.level}`)},[o("a",{href:`#${s.id}`,onClick:Z(p=>D(s.id),["prevent"])},f(s.text),9,he)],2))),128))])])],512)):$("",!0)]),O.value.length>0?(c(),r("section",ke,[e[5]||(e[5]=o("h2",null,"Related Projects",-1)),o("div",ye,[(c(!0),r(j,null,L(O.value,s=>(c(),r("article",{key:s.id,class:"related-card"},[o("div",_e,[T(i,{to:`/projects/${s.id}`},{default:M(()=>[o("img",{src:z(s.image),alt:s.title,loading:"lazy"},null,8,$e)]),_:2},1032,["to"])]),o("h3",null,[T(i,{to:`/projects/${s.id}`},{default:M(()=>[I(f(s.title),1)]),_:2},1032,["to"])]),o("p",null,f(s.description),1),o("div",we,[(c(!0),r(j,null,L(s.tags.slice(0,3),p=>(c(),r("span",{key:p,class:"tag"},f(p),1))),128))])]))),128))])])):$("",!0)])):$("",!0)])])}}}),Ce=ee(be,[["__scopeId","data-v-ae722eff"]]);export{Ce as default};
