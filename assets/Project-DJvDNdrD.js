import{d as I,r as g,c as z,q as A,o as W,a as q,b as a,e as l,h as $,l as T,w as M,m as Y,j as G,f as v,F as j,g as b,s as J,i as K,k as r,n as Q,v as X,p as B,_ as Z}from"./index-DnhKKmfQ.js";import{M as R}from"./projects-CYWVl5qh.js";const ee={class:"project-detail"},te={class:"project-container"},le={key:0,class:"loading-state"},se={key:1,class:"error-state"},oe={key:2},ne={class:"project-image"},ae=["alt"],re={class:"project-content"},ce={class:"content-main"},ie={class:"project-links"},ue=["href"],de=["href"],ge={class:"project-tags"},pe=["innerHTML"],ve={key:1,class:"content-loading"},me={class:"toc","aria-label":"Table of contents"},fe=["href","onClick"],he={key:0,class:"related-projects"},ke={class:"related-grid grid grid-responsive"},_e={class:"related-image"},ye=["src","alt"],$e={class:"related-tags"},we=I({__name:"Project",props:{slug:{}},emits:["sticky-title-change"],setup(F,{emit:U}){const h=F,w=U,o=g(null),C=g([]),i=g(""),p=g([]),x=g(!1),L=g(null),k=g(),V=g();let _=null;const O=z(()=>!o.value||!C.value.length?[]:C.value.filter(e=>e.id!==o.value.id&&(e.category===o.value.category||e.tags.some(t=>o.value.tags.includes(t)))).slice(0,4)),S=e=>{if(!e)return"";if(e.startsWith("http"))return e;const t=window.location.hostname==="mrleemurray.github.io"?"/site":"";return e.startsWith("/")?`${t}${e}`:`${t}/${e}`},P=async()=>{console.log("üöÄ loadProject called for slug:",h.slug),x.value=!0,L.value=null,o.value=null,i.value="",p.value=[],w("sticky-title-change",null);try{console.log("üì• Loading projects data...");const e=await R.loadProjectsData();C.value=e.projects,console.log("‚úÖ Projects data loaded:",e.projects.length),console.log("üìÑ Loading project content for:",h.slug);const t=await R.loadProjectContent(h.slug);o.value=t.frontmatter,console.log("‚úÖ Project frontmatter loaded:",o.value.title),console.log("üìù Raw content length:",t.content.length),console.log("üìù Content preview:",t.content.substring(0,200)),console.log("üîß Starting enhanced markdown processing..."),console.log("üîß Raw markdown sample:",t.content.substring(0,500)),w("sticky-title-change",o.value.title);const u=window.location.hostname==="mrleemurray.github.io"?"/site":"";console.log("üîó Base path:",u),console.log("‚öôÔ∏è Processing markdown with fallback approach...");const m=t.content.matchAll(/^(#{1,6})\s+(.*)$/gm),s=Array.from(m).map(c=>{const n=c[1].length,d=c[2].trim(),y=d.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");return{level:n,text:d,id:y}});p.value=s,console.log("üìö TOC extracted:",p.value.length,"items"),p.value.length>0&&console.log("üìö TOC items:",p.value);let f=t.content.replace(/^### (.*$)/gim,(c,n)=>`<h3 id="${n.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}">${n}</h3>`).replace(/^## (.*$)/gim,(c,n)=>`<h2 id="${n.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}">${n}</h2>`).replace(/^# (.*$)/gim,(c,n)=>`<h1 id="${n.trim().toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}">${n}</h1>`).replace(/\*\*\*(.*?)\*\*\*/g,"<strong><em>$1</em></strong>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/::: info\n([\s\S]*?)\n:::/g,'<div class="callout callout-info"><p>$1</p></div>').replace(/::: tip\n([\s\S]*?)\n:::/g,'<div class="callout callout-tip"><p>$1</p></div>').replace(/::: warning\n([\s\S]*?)\n:::/g,'<div class="callout callout-warning"><p>$1</p></div>').replace(/::: danger\n([\s\S]*?)\n:::/g,'<div class="callout callout-danger"><p>$1</p></div>').replace(/^- \[ \] (.*)$/gm,'<li class="task-list-item"><input type="checkbox" disabled> $1</li>').replace(/^- \[x\] (.*)$/gm,'<li class="task-list-item"><input type="checkbox" checked disabled> $1</li>').replace(/==(.*?)==/g,"<mark>$1</mark>").replace(/\+\+(.*?)\+\+/g,"<ins>$1</ins>").replace(/```(\w+)?\n([\s\S]*?)```/g,'<pre><code class="hljs language-$1">$2</code></pre>').replace(/`([^`]+)`/g,"<code>$1</code>").replace(/!\[([^\]]*)\]\(([^)]+)\)/g,(c,n,d)=>{const y=n||"Project image",E=S(d);return console.log("üñºÔ∏è Processing image:",{original:d,processed:E}),`<img src="${E}" alt="${y}" />`}).replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>').replace(/^- (.*)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)(\n<li>.*<\/li>)*/g,c=>"<ul>"+c.replace(/\n/g,"")+"</ul>").replace(/(<li class="task-list-item">.*<\/li>)(\n<li class="task-list-item">.*<\/li>)*/g,c=>"<ul>"+c.replace(/\n/g,"")+"</ul>").split(`

`).map(c=>{const n=c.trim();return n===""?"":n.startsWith("<")?n:`<p>${n}</p>`}).filter(c=>c!=="").join(`
`);i.value=f,console.log("‚úÖ Manual markdown processing complete, length:",i.value.length),console.log("üé® Final content preview:",i.value.substring(0,300)),await J(),console.log("üîç Final markdown content check:",{hasCallouts:i.value.includes("callout-"),hasTaskLists:i.value.includes("task-list-item"),hasHTML:i.value.includes("<"),isEmpty:i.value.trim()===""}),setTimeout(()=>{D()},100)}catch(e){console.error("‚ùå Error loading project:",e),L.value=e instanceof Error?e.message:"Failed to load project"}finally{x.value=!1,console.log("üèÅ loadProject completed")}};A(()=>h.slug,()=>{P()});const D=()=>{if(!k.value)return;const e=document.createElement("div");e.style.height="1px",e.style.position="absolute",e.style.top="calc(var(--space-16) - 7px)",e.style.left="0",e.style.right="0",e.style.pointerEvents="none",e.setAttribute("data-sticky-sentinel","true"),k.value.parentNode?.insertBefore(e,k.value),_=new IntersectionObserver(t=>{t.forEach(u=>{u.target===e&&(!u.isIntersecting&&o.value?.title?w("sticky-title-change",o.value.title):window.innerWidth<=767||w("sticky-title-change",null))})},{rootMargin:"0px",threshold:0}),_.observe(e)},H=()=>{_&&(_.disconnect(),_=null),document.querySelectorAll("[data-sticky-sentinel]").forEach(t=>t.remove())},N=e=>{const t=document.getElementById(e);if(!t)return;const u=k.value?.offsetHeight||0,m=getComputedStyle(document.documentElement),n=(parseFloat(m.getPropertyValue("--space-16"))*16||64)-6+u+20,y=t.getBoundingClientRect().top+window.pageYOffset-n;window.scrollTo({top:y,behavior:"smooth"})};return W(()=>{P()}),q(()=>{H()}),(e,t)=>{const u=K("router-link"),m=G("lazy");return r(),a("div",ee,[l("div",te,[x.value?(r(),a("div",le,[...t[0]||(t[0]=[l("div",{class:"loading-spinner"},null,-1),l("p",null,"Loading project...",-1)])])):L.value?(r(),a("div",se,[t[2]||(t[2]=l("h2",null,"Project Not Found",-1)),T(u,{to:"/",class:"btn btn-primary"},{default:M(()=>[...t[1]||(t[1]=[B(" ‚Üê Back to Projects ",-1)])]),_:1})])):o.value?(r(),a("div",oe,[l("div",ne,[Y(l("img",{alt:o.value.title},null,8,ae),[[m,S(o.value.image)]])]),l("div",re,[l("div",ce,[l("div",{ref_key:"projectMetaRef",ref:k,class:"project-meta"},[l("div",ie,[o.value.liveUrl?(r(),a("a",{key:0,href:o.value.liveUrl,class:"project-link",target:"_blank",rel:"noopener noreferrer"},v(o.value.liveUrlLabel||"View Live Site"),9,ue)):$("",!0),o.value.sourceUrl?(r(),a("a",{key:1,href:o.value.sourceUrl,class:"project-link",target:"_blank",rel:"noopener noreferrer"},v(o.value.sourceUrlLabel||"View Source"),9,de)):$("",!0)]),l("div",ge,[(r(!0),a(j,null,b(o.value.tags,s=>(r(),a("span",{key:s,class:"tag"},v(s),1))),128))])],512),i.value?(r(),a("div",{key:`markdown-${h.slug}-${i.value.length}`,class:"markdown-content",innerHTML:i.value},null,8,pe)):(r(),a("div",ve,[...t[3]||(t[3]=[l("p",null,"Loading project details...",-1)])]))]),p.value.length>0?(r(),a("aside",{key:0,ref_key:"tocRef",ref:V,class:"content-sidebar"},[l("nav",me,[t[4]||(t[4]=l("h3",null,"Table of Contents",-1)),l("ul",null,[(r(!0),a(j,null,b(p.value,s=>(r(),a("li",{key:s.id,class:Q(`toc-level-${s.level}`)},[l("a",{href:`#${s.id}`,onClick:X(f=>N(s.id),["prevent"])},v(s.text),9,fe)],2))),128))])])],512)):$("",!0)]),O.value.length>0?(r(),a("section",he,[t[5]||(t[5]=l("h2",null,"Related Projects",-1)),l("div",ke,[(r(!0),a(j,null,b(O.value,s=>(r(),a("article",{key:s.id,class:"related-card"},[l("div",_e,[T(u,{to:`/projects/${s.id}`},{default:M(()=>[l("img",{src:S(s.image),alt:s.title,loading:"lazy"},null,8,ye)]),_:2},1032,["to"])]),l("h3",null,[T(u,{to:`/projects/${s.id}`},{default:M(()=>[B(v(s.title),1)]),_:2},1032,["to"])]),l("p",null,v(s.description),1),l("div",$e,[(r(!0),a(j,null,b(s.tags.slice(0,3),f=>(r(),a("span",{key:f,class:"tag"},v(f),1))),128))])]))),128))])])):$("",!0)])):$("",!0)])])}}}),Ce=Z(we,[["__scopeId","data-v-996dc1e1"]]);export{Ce as default};
